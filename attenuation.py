import scipy
import matplotlib.pyplot as plt
from matplotlib import rc
import scipy.interpolate

rc('text',usetex=True)
rc('font',**{'family':'serif','serif':['Computer Modern Roman']})
rc('font',size=22)#14)#size=14

density = scipy.array([8.]) #g/cm^3
#Fe C Cr Al Ni Mo Mn S Si
byweight = [.65,.003,.17,0.,.12,.025,.02,.002,.01]
idx = 8

Al = 2.7

M = [scipy.array([[0.001,9085,9052], #Fe
                  [0.0015,3399,3388],
                  [0.002,1626,1620],
                  [0.003,557.6,553.5],
                  [0.004,256.7,253.6],
                  [0.005,139.8,137.2],
                  [0.006,84.84,82.65],
                  [0.007112,53.19,51.33],
                  [0.007112,407.6,297.8],
                  [0.008,305.6,231.6],
                  [0.01,170.6,136.9],
                  [0.015,57.08,48.96],
                  [0.02,25.68,22.6],
                  [0.03,8.176,7.251],
                  [0.04,3.629,3.155],
                  [0.05,1.958,1.638],
                  [0.06,1.205,0.9555],
                  [0.08,0.5952,0.4104],
                  [0.1,0.3717,0.2177],
                  [0.15,0.1964,0.07961],
                  [0.2,0.146,0.04825],
                  [0.3,0.1099,0.03361],
                  [0.4,0.094,0.03039],
                  [0.5,0.08414,0.02914],
                  [0.6,0.07704,0.02836],
                  [0.8,0.06699,0.02714],
                  [1,0.05995,0.02603],
                  [1.25,0.0535,0.02472],
                  [1.5,0.04883,0.0236],
                  [2,0.04265,0.02199],
                  [3,0.03621,0.02042],
                  [4,0.03312,0.0199],
                  [5,0.03146,0.01983],
                  [6,0.03057,0.01997],
                  [8,0.02991,0.0205],
                  [10,0.02994,0.02108],
                  [15,0.03092,0.02221],
                  [20,0.03224,0.02292]]),
     scipy.array([[0.001,2211,2209], #C
                  [0.0015,700.2,699],
                  [0.002,302.6,301.6],
                  [0.003,90.33,89.63],
                  [0.004,37.78,37.23],
                  [0.005,19.12,18.66],
                  [0.006,10.95,10.54],
                  [0.008,4.576,4.242],
                  [0.01,2.373,2.078],
                  [0.015,0.8071,0.5627],
                  [0.02,0.442,0.2238],
                  [0.03,0.2562,0.06614],
                  [0.04,0.2076,0.03343],
                  [0.05,0.1871,0.02397],
                  [0.06,0.1753,0.02098],
                  [0.08,0.161,0.02037],
                  [0.1,0.1514,0.02147],
                  [0.15,0.1347,0.02449],
                  [0.2,0.1229,0.02655],
                  [0.3,0.1066,0.0287],
                  [0.4,0.09546,0.0295],
                  [0.5,0.08715,0.02969],
                  [0.6,0.08058,0.02956],
                  [0.8,0.07076,0.02885],
                  [1,0.06361,0.02792],
                  [1.25,0.0569,0.02669],
                  [1.5,0.05179,0.02551],
                  [2,0.04442,0.02345],
                  [3,0.03562,0.02048],
                  [4,0.03047,0.01849],
                  [5,0.02708,0.0171],
                  [6,0.02469,0.01607],
                  [8,0.02154,0.01468],
                  [10,0.01959,0.0138],
                  [15,0.01698,0.01258],
                  [20,0.01575,0.01198]]),
     scipy.array([[0.001,7405,7388], #Cr
                  [0.0015,2694,2687],
                  [0.002,1277,1272],
                  [0.003,433.9,430.5],
                  [0.004,198.8,196.1],
                  [0.005,108,105.7],
                  [0.0059892,65.74,63.83],
                  [0.0059892,597.7,402.7],
                  [0.006,516,402.7],
                  [0.008,251.3,208.7],
                  [0.01,138.6,119.3],
                  [0.015,45.71,40.93],
                  [0.02,20.38,18.46],
                  [0.03,6.434,5.78],
                  [0.04,2.856,2.482],
                  [0.05,1.55,1.278],
                  [0.06,0.9639,0.742],
                  [0.08,0.4905,0.3182],
                  [0.1,0.3166,0.1701],
                  [0.15,0.1788,0.06536],
                  [0.2,0.1378,0.04211],
                  [0.3,0.1067,0.0316],
                  [0.4,0.09213,0.02938],
                  [0.5,0.08281,0.02849],
                  [0.6,0.07598,0.02788],
                  [0.8,0.0662,0.0268],
                  [1,0.0593,0.02576],
                  [1.25,0.05295,0.0245],
                  [1.5,0.04832,0.0234],
                  [2,0.04213,0.02178],
                  [3,0.03559,0.02011],
                  [4,0.03235,0.01947],
                  [5,0.03057,0.01929],
                  [6,0.02956,0.01933],
                  [8,0.02869,0.0197],
                  [10,0.02855,0.02016],
                  [15,0.0292,0.02112],
                  [20,0.03026,0.02174]]),
     scipy.array([[0.001,1185,1183], #Al
                  [0.0015,402.2,400.1],
                  [0.0015596,362.1,360],
                  [0.0015596,3957,3829],
                  [0.002,2263,2204],
                  [0.003,788,773.2],
                  [0.004,360.5,354.5],
                  [0.005,193.4,190.2],
                  [0.006,115.3,113.3],
                  [0.008,50.33,49.18],
                  [0.01,26.23,25.43],
                  [0.015,7.955,7.487],
                  [0.02,3.441,3.094],
                  [0.03,1.128,0.8778],
                  [0.04,0.5685,0.3601],
                  [0.05,0.3681,0.184],
                  [0.06,0.2778,0.1099],
                  [0.08,0.2018,0.05511],
                  [0.1,0.1704,0.03794],
                  [0.15,0.1378,0.02827],
                  [0.2,0.1223,0.02745],
                  [0.3,0.1042,0.02816],
                  [0.4,0.09276,0.02862],
                  [0.5,0.08445,0.02868],
                  [0.6,0.07802,0.02851],
                  [0.8,0.06841,0.02778],
                  [1,0.06146,0.02686],
                  [1.25,0.05496,0.02565],
                  [1.5,0.05006,0.02451],
                  [2,0.04324,0.02266],
                  [3,0.03541,0.02024],
                  [4,0.03106,0.01882],
                  [5,0.02836,0.01795],
                  [6,0.02655,0.01739],
                  [8,0.02437,0.01678],
                  [10,0.02318,0.0165],
                  [15,0.02195,0.01631],
                  [20,0.02168,0.01633]]),
     scipy.array([[0.001,9855,9797], #Ni
                  [0.00100404,9753,9697],
                  [0.0010081,9654,9598],
                  [0.0010081,10990,10930],
                  [0.0015,4234,4214],
                  [0.002,2049,2039],
                  [0.003,709.4,704.2],
                  [0.004,328.2,324.4],
                  [0.005,179.3,176.1],
                  [0.006,109,106.4],
                  [0.008,49.52,47.58],
                  [0.0083328,44.28,42.42],
                  [0.0083328,329.4,224],
                  [0.01,209,152.4],
                  [0.015,70.81,57.34],
                  [0.02,32.2,27.22],
                  [0.03,10.34,8.982],
                  [0.04,4.6,3.967],
                  [0.05,2.474,2.078],
                  [0.06,1.512,1.219],
                  [0.08,0.7306,0.5259],
                  [0.1,0.444,0.2781],
                  [0.15,0.2208,0.09812],
                  [0.2,0.1582,0.05649],
                  [0.3,0.1154,0.03659],
                  [0.4,0.09765,0.03209],
                  [0.5,0.08698,0.03036],
                  [0.6,0.07944,0.02937],
                  [0.8,0.06891,0.02795],
                  [1,0.0616,0.02674],
                  [1.25,0.05494,0.02536],
                  [1.5,0.05015,0.0242],
                  [2,0.04387,0.02257],
                  [3,0.03745,0.02107],
                  [4,0.03444,0.02066],
                  [5,0.03289,0.0207],
                  [6,0.0321,0.02094],
                  [8,0.03164,0.02163],
                  [10,0.03185,0.02234],
                  [15,0.0332,0.02368],
                  [20,0.03476,0.02446]]),
     scipy.array([[0.001,4942,4935], #Mo
                  [0.0015,1925,1918],
                  [0.002,959.3,953.1],
                  [0.0025202,541.5,535.8],
                  [0.0025202,1979,1924],
                  [0.00257212,1854,1802],
                  [0.0026251,1750,1703],
                  [0.0026251,2433,2360],
                  [0.00274267,2183,2119],
                  [0.0028655,1961,1906],
                  [0.0028655,2243,2179],
                  [0.003,2011,1956],
                  [0.004,970.3,947.5],
                  [0.005,545,532.8],
                  [0.006,337.3,329.5],
                  [0.008,156.5,152.2],
                  [0.01,85.76,82.75],
                  [0.015,28.54,26.84],
                  [0.0199995,13.08,11.93],
                  [0.0199995,80.55,32.93],
                  [0.02,80.54,33.36],
                  [0.03,28.1,16.64],
                  [0.04,12.94,8.757],
                  [0.05,7.037,5.074],
                  [0.06,4.274,3.178],
                  [0.08,1.962,1.477],
                  [0.1,1.096,0.8042],
                  [0.15,0.4208,0.2693],
                  [0.2,0.2423,0.1316],
                  [0.3,0.1379,0.05919],
                  [0.4,0.1047,0.04117],
                  [0.5,0.08848,0.03437],
                  [0.6,0.07851,0.03104],
                  [0.8,0.06619,0.02764],
                  [1,0.05837,0.02567],
                  [1.25,0.05167,0.0239],
                  [1.5,0.04713,0.02263],
                  [2,0.04163,0.02118],
                  [3,0.03675,0.02046],
                  [4,0.03496,0.02084],
                  [5,0.03439,0.02153],
                  [6,0.0344,0.02231],
                  [8,0.03523,0.02382],
                  [10,0.0365,0.02513],
                  [15,0.03978,0.02731],
                  [20,0.04264,0.0284]]),
     scipy.array([[0.001,8093,8069], #Mn
                  [0.0015,2984,2975],
                  [0.002,1421,1415],
                  [0.003,485.1,481.5],
                  [0.004,222.9,220.1],
                  [0.005,121.2,118.8],
                  [0.006,73.5,71.5],
                  [0.006539,58.03,56.19],
                  [0.006539,452,341.5],
                  [0.008,273.4,217.7],
                  [0.01,151.4,126.2],
                  [0.015,50.27,44.14],
                  [0.02,22.53,20.15],
                  [0.03,7.141,6.382],
                  [0.04,3.169,2.757],
                  [0.05,1.714,1.425],
                  [0.06,1.06,0.8294],
                  [0.08,0.5306,0.3558],
                  [0.1,0.3367,0.1894],
                  [0.15,0.1838,0.07085],
                  [0.2,0.1391,0.04421],
                  [0.3,0.1062,0.03196],
                  [0.4,0.09133,0.02932],
                  [0.5,0.08192,0.02827],
                  [0.6,0.07509,0.0276],
                  [0.8,0.06537,0.02647],
                  [1,0.05852,0.02541],
                  [1.25,0.05224,0.02416],
                  [1.5,0.04769,0.02307],
                  [2,0.04162,0.02149],
                  [3,0.03524,0.01989],
                  [4,0.03213,0.01933],
                  [5,0.03045,0.0192],
                  [6,0.02952,0.0193],
                  [8,0.02875,0.01973],
                  [10,0.02871,0.02025],
                  [15,0.02951,0.02127],
                  [20,0.03068,0.02193]]),
     scipy.array([[0.001,2429,2426], #S
                  [0.0015,834.2,831.4],
                  [0.002,385.3,382.8],
                  [0.002472,216.8,214.5],
                  [0.002472,2070,1935],
                  [0.003,1339,1265],
                  [0.004,633.8,606.6],
                  [0.005,348.7,336],
                  [0.006,211.6,204.6],
                  [0.008,94.65,91.71],
                  [0.01,50.12,48.47],
                  [0.015,15.5,14.77],
                  [0.02,6.708,6.235],
                  [0.03,2.113,1.809],
                  [0.04,0.9872,0.7466],
                  [0.05,0.5849,0.3779],
                  [0.06,0.4053,0.2199],
                  [0.08,0.2585,0.1],
                  [0.1,0.202,0.06052],
                  [0.15,0.1506,0.03516],
                  [0.2,0.1302,0.0308],
                  [0.3,0.1091,0.02983],
                  [0.4,0.09665,0.02991],
                  [0.5,0.08781,0.02984],
                  [0.6,0.08102,0.02959],
                  [0.8,0.07098,0.02878],
                  [1,0.06373,0.0278],
                  [1.25,0.05697,0.02652],
                  [1.5,0.05193,0.02535],
                  [2,0.04498,0.02349],
                  [3,0.03715,0.02118],
                  [4,0.03293,0.01993],
                  [5,0.03036,0.01923],
                  [6,0.02872,0.01884],
                  [8,0.02682,0.0185],
                  [10,0.02589,0.01845],
                  [15,0.02517,0.01864],
                  [20,0.02529,0.01889]]),
     scipy.array([[0.001,1570,1567], #Si
                  [0.0015,535.5,533.1],
                  [0.0018389,309.2,307],
                  [0.0018389,3192,3059],
                  [0.002,2777,2669],
                  [0.003,978.4,951.6],
                  [0.004,452.9,442.7],
                  [0.005,245,240],
                  [0.006,147,143.9],
                  [0.008,64.68,63.13],
                  [0.01,33.89,32.89],
                  [0.015,10.34,9.794],
                  [0.02,4.464,4.076],
                  [0.03,1.436,1.164],
                  [0.04,0.7012,0.4782],
                  [0.05,0.4385,0.243],
                  [0.06,0.3207,0.1434],
                  [0.08,0.2228,0.06896],
                  [0.1,0.1835,0.04513],
                  [0.15,0.1448,0.03086],
                  [0.2,0.1275,0.02905],
                  [0.3,0.1082,0.02932],
                  [0.4,0.09614,0.02968],
                  [0.5,0.08748,0.02971],
                  [0.6,0.08077,0.02951],
                  [0.8,0.07082,0.02875],
                  [1,0.06361,0.02778],
                  [1.25,0.05688,0.02652],
                  [1.5,0.05183,0.02535],
                  [2,0.0448,0.02345],
                  [3,0.03678,0.02101],
                  [4,0.0324,0.01963],
                  [5,0.02967,0.01878],
                  [6,0.02788,0.01827],
                  [8,0.02574,0.01773],
                  [10,0.02462,0.01753],
                  [15,0.02352,0.01746],
                  [20,0.02338,0.01757]])]

def plot(r=[10,70],pts=1e3,x=.03*2.54,c='k',label=' '):

    data = scipy.ones((pts,))
    E = scipy.linspace(r[0],r[1],pts)

    for i in xrange(idx):
        interp = scipy.interpolate.interp1d(scipy.log(M[idx][:,0]),
                                            scipy.log(M[idx][:,1]),
                                            bounds_error=False,
                                            fill_value=0.)
        data = data*scipy.exp(-scipy.exp(interp(scipy.log(E/1e3)))*density*x*byweight[idx])

    
    interp = scipy.interpolate.interp1d(scipy.log(M[3][:,0]),
                                        scipy.log(M[3][:,1]),
                                        bounds_error=False,
                                        fill_value=0.)
    data = data*scipy.exp(-scipy.exp(interp(scipy.log(E/1e3)))*Al*1e-3)

    plt.plot(E,data,color=c,label=label,linewidth=2.)

def plot2(r=[10,70],pts=1e3,x=.03*2.54,c='b',label=' '):

    data = scipy.ones((pts,))
    E = scipy.linspace(r[0],r[1],pts)

    for i in xrange(idx):
        interp = scipy.interpolate.interp1d(scipy.log(M[idx][:,0]),
                                            scipy.log(M[idx][:,1]),
                                            fill_value=0.)
        data = data*scipy.exp(-scipy.exp(interp(scipy.log(E/1e3)))*density*x*byweight[idx])


    plt.plot(E,data,color=c,label=label,linewidth=2.)


def figure():

    plot(x=0.,c='#0E525A',label='only window')
    plot(x=.015*2.54,c='#A02C2C',label='+.015" 316L')
    plot(x=.03*2.54,c='#228B22',label='+.03" 316L')
    plot(x=.06*2.54,c='#800080',label='+.06" 316L')
    plt.xlabel('X-ray energy [keV]')
    plt.ylabel('T(E)')
    plt.legend(loc=4)
    plt.show()
